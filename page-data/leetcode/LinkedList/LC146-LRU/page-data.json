{"componentChunkName":"component---src-gatsby-theme-portfolio-minimal-templates-article-index-tsx","path":"/leetcode/LinkedList/LC146-LRU/","result":{"pageContext":{"article":{"banner":{"alt":"First Markdown Post","caption":"Linked List <u><a href=\"https://leetcode.com/problems/lru-cache/\"> LeetCode</a></u>","src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABRElEQVR42pVSz0vDMBjt/+vJHyf/AfEu6mEwocx5sCB4KIXiQQcWO1rp1mxjmIXm0OJycHWWtmm/yBrp3GBuvkNIyHvf976XKGIziqIQAv4gKJsuygUgnicA8D9xWZZCiPu728bZaX3cSSypj0+d46O95OVEpNOqNWwXS5NJkhwe7EfTj4CQ4G24xfbvweT+/OJSu25wdJUwLHbpvIgIQNr+/Mr8zo14f4CqXA3JWRFzzteq8DzPCwjZvKYCwBpNkcp+v885p5TOZjPGGCHEsqxX1x2NhowxSmmapp7nua4bRVEcx0txnue9Xg9j3Gw2DcNot9uappmm6ThOlmXPFXRd73a7rVZLVVXbtqW7H9vj8dj3fdu2J5OJ4zgIIYxxEASe52GMB4MBIQQhRCm1LCsMQznFMu06CbnW4dURVr915V2+AVClp1w0wZmRAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/2eeafdaeb2484ec1519ee2185116244a/bc51f/leetcode.png","srcSet":"/static/2eeafdaeb2484ec1519ee2185116244a/41200/leetcode.png 165w,\n/static/2eeafdaeb2484ec1519ee2185116244a/f979a/leetcode.png 330w,\n/static/2eeafdaeb2484ec1519ee2185116244a/bc51f/leetcode.png 660w","sizes":"(min-width: 660px) 660px, 100vw"},"sources":[{"srcSet":"/static/2eeafdaeb2484ec1519ee2185116244a/322ad/leetcode.webp 165w,\n/static/2eeafdaeb2484ec1519ee2185116244a/de3b3/leetcode.webp 330w,\n/static/2eeafdaeb2484ec1519ee2185116244a/2b2b5/leetcode.webp 660w","type":"image/webp","sizes":"(min-width: 660px) 660px, 100vw"}]},"width":660,"height":400}}}},"body":"<h1>LC146. LRU</h1>\n<p><a href=\"https://leetcode.com/problems/lru-cache\">https://leetcode.com/problems/lru-cache</a></p>\n<p>The reason why this problem falls into the Linkedlist category is that\nPut and Get need to be constant time, which can be easily achieved by a dictionary.</p>\n<p>However, it's an LRU, meaning that we need an easy way to track &#x26; modify the ordering of keys and all the operations need to be O(1).</p>\n<p>The idea is that we have a double linked list, and the order of the node represents the history.</p>\n<p>The LL has 2 padding nodes at the beginning and end of the LL, this way we can</p>\n<p>1/Remove any node without worry about the edge case</p>\n<p>2/Get the least recently used node by calling <code class=\"language-text\">tail.prev</code></p>\n<p>For each node, we need to have <code class=\"language-text\">key</code>, <code class=\"language-text\">val</code>, <code class=\"language-text\">prev</code>, <code class=\"language-text\">next</code>, noted that we do need <code class=\"language-text\">key</code> for getting the key to delete record in the dictionary.</p>\n<p>We also have a dictionary of (key -> node), so that we can get the node given a key</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># https://leetcode.com/problems/lru-cache/</span>\n<span class=\"token comment\"># The reason why this problem falls into the Linkedlist category is that</span>\n<span class=\"token comment\"># Put and Get need to be constant time, which can be easily achieved by dictionary.</span>\n\n<span class=\"token comment\"># However, it's an LRU, meaning that we need an easy way to track &amp; modify the ordering of keys and all the operations need to be O(1).</span>\n\n<span class=\"token comment\"># The idea is that we have a double linked list, and the order of the node represents the history.</span>\n\n<span class=\"token comment\"># The LL has 2 padding nodes at the beginning and end of the LL, this way we can</span>\n\n<span class=\"token comment\"># 1/Remove any node without worry about the edge case</span>\n\n<span class=\"token comment\"># 2/Get the least recently used node by calling `tail.prev`</span>\n\n<span class=\"token comment\"># For each node, we need to have `key`, `val`, `prev`, `next`, noted that we do need `key` for getting the key to delete record in the dictionary.</span>\n\n<span class=\"token comment\"># We also have a dictionary of (key -> node), so that we can get the node given a key</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ListNode</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"\n    Double LL node with key and val attributes\n    \"\"\"</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> key<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> val<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> prev<span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">next</span><span class=\"token operator\">=</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>key <span class=\"token operator\">=</span> key\n        self<span class=\"token punctuation\">.</span>val <span class=\"token operator\">=</span> val\n        self<span class=\"token punctuation\">.</span>prev <span class=\"token operator\">=</span> prev\n        self<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">next</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">LRUCache</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> capacity<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        Initialize 2 padding nodes that linked to each other w/o putting them in dictionary\n        \"\"\"</span>\n        head <span class=\"token operator\">=</span> ListNode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        tail <span class=\"token operator\">=</span> ListNode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        head<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span> <span class=\"token operator\">=</span> tail\n        tail<span class=\"token punctuation\">.</span>prev <span class=\"token operator\">=</span> head\n        self<span class=\"token punctuation\">.</span>head <span class=\"token operator\">=</span> head\n        self<span class=\"token punctuation\">.</span>tail <span class=\"token operator\">=</span> tail\n        self<span class=\"token punctuation\">.</span>capactity <span class=\"token operator\">=</span> capacity\n        self<span class=\"token punctuation\">.</span>d <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\"># now, we need a way to add and remove a node in the LL</span>\n    <span class=\"token comment\"># Noted that we don't need to consider ordering and capacity now, just simple add and remove</span>\n    <span class=\"token comment\"># We can use this wheel to complete the more complext logic</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_add</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        For adding, there's only 1 way to add - add behind the padding head.\n        \"\"\"</span>\n        old_top <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span>\n        self<span class=\"token punctuation\">.</span>head<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span> <span class=\"token operator\">=</span> node\n        node<span class=\"token punctuation\">.</span>prev <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>head\n        node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span> <span class=\"token operator\">=</span> old_top\n        old_top<span class=\"token punctuation\">.</span>prev <span class=\"token operator\">=</span> node\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_remove</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        Since we have 2 padding nodes we can simply remove the give node by joining its prev and next\n        \"\"\"</span>\n        prev_node <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span>prev\n        next_node <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span>\n        prev_node<span class=\"token punctuation\">.</span><span class=\"token builtin\">next</span> <span class=\"token operator\">=</span> next_node\n        next_node<span class=\"token punctuation\">.</span>prev <span class=\"token operator\">=</span> prev_node\n\n    <span class=\"token comment\"># next we need an update logic - given a node, change it from the current position to top</span>\n    <span class=\"token comment\"># this is now easy since we can just remove it and add</span>\n    <span class=\"token comment\"># noted that we still don't care about capacity and other logics.</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">_update</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token triple-quoted-string string\">\"\"\"\n        Delete first, then add.\n        \"\"\"</span>\n        self<span class=\"token punctuation\">.</span>_remove<span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>_add<span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span>\n\n\n    <span class=\"token comment\"># Get is relatively easy</span>\n    <span class=\"token comment\"># just get the value then update the position</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> key <span class=\"token keyword\">not</span> <span class=\"token keyword\">in</span> self<span class=\"token punctuation\">.</span>d<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            node <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>d<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span>\n            self<span class=\"token punctuation\">.</span>_update<span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> node<span class=\"token punctuation\">.</span>val\n\n    <span class=\"token comment\"># for put if key exist, simply update the value of the node and reposition</span>\n    <span class=\"token comment\"># if LRU is full, remove the key **and** the node and add the new node</span>\n    <span class=\"token comment\"># if LRU isn't full, simply add node</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">put</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> key <span class=\"token keyword\">in</span> self<span class=\"token punctuation\">.</span>d<span class=\"token punctuation\">:</span>\n            node <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>d<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span>\n            node<span class=\"token punctuation\">.</span>val <span class=\"token operator\">=</span> value\n            self<span class=\"token punctuation\">.</span>_update<span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">elif</span> self<span class=\"token punctuation\">.</span>capactity <span class=\"token operator\">></span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            new_top <span class=\"token operator\">=</span> ListNode<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>_add<span class=\"token punctuation\">(</span>new_top<span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>d<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> new_top\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            last_node <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>tail<span class=\"token punctuation\">.</span>prev\n            self<span class=\"token punctuation\">.</span>_remove<span class=\"token punctuation\">(</span>last_node<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">del</span> self<span class=\"token punctuation\">.</span>d<span class=\"token punctuation\">[</span>last_node<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">]</span>\n            new_top <span class=\"token operator\">=</span> ListNode<span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>_add<span class=\"token punctuation\">(</span>new_top<span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>d<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> new_top\n</code></pre></div>","categories":["LinkedList"],"date":"May 04, 2023","description":"Linked List Leetcode","id":"2ef98813-3d74-533c-bd87-9d1d21fc7cbd","keywords":["LinkedList","Leetcode","LinkedList","LRU","Application","Double-LinkedList"],"slug":"/leetcode/LinkedList/LC146-LRU/","title":"LC146. LRU","readingTime":{"text":"4 min read"}},"listingPagePath":"/blog"}},"staticQueryHashes":["172304273","948380417"],"slicesMap":{}}